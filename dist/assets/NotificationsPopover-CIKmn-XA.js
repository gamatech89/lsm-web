import{t as z,u as E,r as _,v as N,c as h,d as j,j as e,g as T,B as m,w as q,E as v,L as w,x as A,y as B,z as M,G as $,H as K,J as P,K as F,p as n}from"./index-sz0gi067.js";const{Text:d}=T;function Q(){var x,g;const a=z(),c=E(),[o,f]=_.useState(!1),{resolvedTheme:k}=N(),i=k==="dark",{data:r}=h({queryKey:["notifications","unread-count"],queryFn:()=>n.notifications.getUnreadCount().then(t=>t.data),refetchInterval:3e4}),{data:l,isLoading:S}=h({queryKey:["notifications","list"],queryFn:()=>n.notifications.list().then(t=>t.data),enabled:o}),b=j({mutationFn:t=>n.notifications.markAsRead(t),onSuccess:()=>{c.invalidateQueries({queryKey:["notifications"]})}}),u=j({mutationFn:()=>n.notifications.markAllAsRead(),onSuccess:()=>{c.invalidateQueries({queryKey:["notifications"]})}}),R=t=>{t.read_at||b.mutate(t.id);const{type:C,data:s}=t;s.project_id?C.includes("Todo")?a(`/projects/${s.project_id}`):a(`/projects/${s.project_id}`):s.url&&a(s.url),f(!1)},p=((x=l==null?void 0:l.data)==null?void 0:x.data)||[],y=((g=r==null?void 0:r.data)==null?void 0:g.count)||0,I=e.jsxs("div",{style:{width:350,maxHeight:400,display:"flex",flexDirection:"column"},children:[e.jsxs("div",{style:{padding:"12px 16px",borderBottom:i?"1px solid #334155":"1px solid #f0f0f0",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(d,{strong:!0,children:"Notifications"}),y>0&&e.jsx(m,{type:"link",size:"small",onClick:()=>u.mutate(),loading:u.isPending,style:{padding:0},children:"Mark all read"})]}),e.jsx("div",{style:{overflowY:"auto",flex:1},children:S?e.jsx("div",{style:{padding:24,textAlign:"center"},children:e.jsx(q,{size:"small"})}):p.length===0?e.jsx(v,{image:v.PRESENTED_IMAGE_SIMPLE,description:"No notifications",style:{margin:"24px 0"}}):e.jsx(w,{dataSource:p,renderItem:t=>e.jsxs("div",{onClick:()=>R(t),style:{padding:"12px 16px",cursor:"pointer",background:t.read_at?"transparent":i?"rgba(99, 102, 241, 0.1)":"#f0f9ff",borderBottom:i?"1px solid #334155":"1px solid #f0f0f0",transition:"background 0.2s",display:"flex",gap:12},className:"notification-item",children:[e.jsx("div",{style:{marginTop:2},children:t.type.includes("Success")||t.type.includes("Completed")?e.jsx(A,{style:{color:"#22c55e",fontSize:16}}):t.type.includes("Warning")||t.type.includes("Alert")?e.jsx(B,{style:{color:"#f59e0b",fontSize:16}}):e.jsx(M,{style:{color:"#6366f1",fontSize:16}})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{marginBottom:4},children:e.jsx(d,{style:{fontSize:13},children:t.data.message||"New notification"})}),e.jsx(d,{type:"secondary",style:{fontSize:11},children:$(t.created_at)})]}),!t.read_at&&e.jsx("div",{style:{display:"flex",alignItems:"center"},children:e.jsx("div",{style:{width:8,height:8,borderRadius:"50%",background:"#6366f1"}})})]})})}),e.jsx("style",{children:`
          .notification-item:hover {
              background: ${i?"rgba(255,255,255,0.05)":"#fafafa"} !important;
          }
      `})]});return e.jsx(K,{content:I,trigger:"click",open:o,onOpenChange:f,placement:"bottomRight",overlayInnerStyle:{padding:0},children:e.jsx(P,{count:y,size:"small",offset:[-4,4],children:e.jsx(m,{type:"text",icon:e.jsx(F,{}),style:{width:40,height:40,color:o?"#6366f1":void 0,borderRadius:10}})})})}export{Q as NotificationsPopover};
//# sourceMappingURL=NotificationsPopover-CIKmn-XA.js.map
